--Phần tạo user với vai trò dưới quyền sa-----
--CREATE USER vai trò dba---
CREATE USER EXBT IDENTIFIED BY "tqhba29041995"
DEFAULT TABLESPACE users
TEMPORARY TABLESPACE temp
PROFILE DEFAULT;
--cấp quyền với trò là dba----
GRANT ALL PRIVILEGES TO EXBT WITH ADMIN OPTION;
GRANT dba, CONNECT TO EXBT WITH ADMIN OPTION;
--bắt đầu tạo bảng và cấp quyền thực hiện các yêu cầu-----
-------------------------------------------------------------------------------------------------
-----Script------
CREATE TABLE NHANVIEN
(
  MANV VARCHAR(20) NOT NULL,
  TENNV VARCHAR(20),
  NGSINH VARCHAR(20),
  DIACHI VARCHAR(50),
  GIOITINH VARCHAR(20),
  MAPB VARCHAR(20),
  MACN VARCHAR(20),
  PRIMARY KEY(MANV)
);
CREATE TABLE DUAN
(
  MADA VARCHAR(20) NOT NULL,
  TENDA VARCHAR(20),
  KINHPHI VARCHAR(20),
  MAPB VARCHAR(20),
  MACN VARCHAR(20),
  TRGDA VARCHAR(20),
  TONGCHI VARCHAR(20),
  PRIMARY KEY (MADA)
);

CREATE TABLE PHONGBAN
(
  MAPB VARCHAR(20) NOT NULL,
  TENPB VARCHAR(20),
  DIADIEM VARCHAR(20),
  TRGPB VARCHAR(20),
  PRIMARY KEY (MAPB)
);

CREATE TABLE CHINHANH
(
  MACN VARCHAR(20) NOT NULL,
  TENCN VARCHAR(20),
  VITRI VARCHAR(20),
  TRGCN VARCHAR(20),
  PRIMARY KEY (MACN)
);
CREATE TABLE PHANCONG
(
  MANV VARCHAR(20) NOT NULL,
  MADA VARCHAR(20) NOT NULL,
  THOIGIAN VARCHAR(20), 
  PRIMARY KEY (MANV, MADA)
);
----------------------------------------------------------
------INSERT DATA----
---NHANVIEN---
INSERT INTO NHANVIEN VALUES ('BS1412123', 'Nguyễn Văn Tài', '15/12/1995', 'Phú Yên', 'Nam', 'PB01', 'MCN01');
INSERT INTO NHANVIEN VALUES ('BS1421124', 'Nguyễn Văn Tú', '15/12/1990', 'Phú Thọ', 'Nam', 'PB02', 'MCN02');
INSERT INTO NHANVIEN VALUES ('BS1412125', 'Nguyễn Văn Huân', '15/12/1995', 'Phú Yên', 'Nam', 'PB03', 'MCN03');
INSERT INTO NHANVIEN VALUES ('BS1412126', 'Nguyễn Trung Tính', '15/05/1994', 'Phú Thọ', 'Nam', 'PB01', 'MCN01');
INSERT INTO NHANVIEN VALUES ('BS1412127', 'Huỳnh Văn Bánh', '20/12/1995', 'Hưng Yên', 'Nam', 'PB02', 'MCN02');
INSERT INTO NHANVIEN VALUES ('BS1412128', 'Huỳnh Thúc Văn', '20/12/1992', 'Khánh Hòa', 'Nam', 'PB03', 'MCN03');
INSERT INTO NHANVIEN VALUES ('BS1012123', 'Lê Tấn Lợi', '20/12/1990', 'Bình Định', 'Nam', '', '');  --GIAMDOC
select * from NHANVIEN;

---DUAN---
INSERT INTO DUAN VALUES ('DA1','Dự Án 1', '5000', 'PB01', 'CN01', 'BS1412123', '6000');
INSERT INTO DUAN VALUES ('DA2', 'Dư Án 2', '6000', 'PB02', 'CN02', 'BS1412124', '7000');
INSERT INTO DUAN VALUES ('DA3','Dự Án 3', '5500', 'PB03', 'CN03', 'BS1415425', '6000');
INSERT INTO DUAN VALUES ('DA4','Dự Án 4', '5500', 'PB03', 'CN04', 'BS1412126', '6000');
select * from DUAN;

--PHONG BAN---
INSERT INTO PHONGBAN VALUES ('PB01','PHÒNG 1','LẦU 1','BS1412123');
INSERT INTO PHONGBAN VALUES ('PB02','PHÒNG 2','LẦU 1', 'BS1412124');
INSERT INTO PHONGBAN VALUES ('PB03','PHÒNG 3','LẦU 1','BS1412125');
select * from PHONGBAN;

---CHI NHANH---
INSERT INTO CHINHANH VALUES ('MCN01', 'Chi Nhánh 1','Quận 1','BS1412123');
INSERT INTO CHINHANH VALUES ('MCN02', 'Chi Nhánh 2','Quận 2','BS1412124');
INSERT INTO CHINHANH VALUES ('MCN03', 'Chi Nhánh 3','Quận 3','BS1412125');
select * from CHINHANH;

--PHAN CONG---
INSERT INTO PHANCONG VALUES ('BS1412123', 'DA1','01/01/2010');
INSERT INTO PHANCONG VALUES ('BS1412124', 'DA2','01/01/2011');
INSERT INTO PHANCONG VALUES ('BS1412125', 'DA3','01/01/2012');
select * from PHANCONG;

-----CREATE USER----
CREATE USER BS1412123 IDENTIFIED BY "123456"
DEFAULT TABLESPACE users
TEMPORARY TABLESPACE temp
PROFILE DEFAULT;

CREATE USER BS1412124 IDENTIFIED BY "123456"
DEFAULT TABLESPACE users
TEMPORARY TABLESPACE temp
PROFILE DEFAULT;

CREATE USER BS1412125 IDENTIFIED BY "123456"
DEFAULT TABLESPACE users
TEMPORARY TABLESPACE temp
PROFILE DEFAULT;

CREATE USER BS1012123 IDENTIFIED BY "123456"
DEFAULT TABLESPACE users
TEMPORARY TABLESPACE temp
PROFILE DEFAULT;

--CREATE ROLE--
CREATE ROLE GIAMDOC;
CREATE ROLE TRUONGPHONG;
CREATE ROLE TRUONGCHINHANH;
CREATE ROLE TRUONGDUAN;
---cấp quyền cho role---
GRANT SELECT ON DUAN TO GIAMDOC;

GRANT UPDATE, INSERT ON DUAN TO TRUONGPHONG;
GRANT UPDATE ON PHONGBAN TO TRUONGPHONG;

GRANT UPDATE ON PHONGBAN TO TRUONGDUAN;

GRANT UPDATE ON PHONGBAN TO TRUONGCHINHANH;

---cấp quyền từ ROLE sang user----
GRANT CREATE SESSION TO BS1012123 WITH ADMIN OPTION;
GRANT GIAMDOC TO BS1012123;
GRANT CREATE SESSION TO BS1412123 WITH ADMIN OPTION;
GRANT TRUONGPHONG TO BS1412123;

GRANT CREATE SESSION TO BS1412124 WITH ADMIN OPTION;
GRANT TRUONGCHINHANH TO BS1412124;

GRANT CREATE SESSION TO BS1412125 WITH ADMIN OPTION;
GRANT TRUONGDUAN TO BS1412125;
-------------------------------------------------------------

